---
title: "Spotify_songs"
author: ''
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
library(dplyr)
library(readr)
library(stringr)
library(hflights)
library(tidyr)
library(lubridate)
library(ggplot2)
```

```{r}
df <- read.csv("spotify_songs.csv")
head(df)
glimpse(df)
summary(df)

```


genre - energy
```{r}
ggplot(df, aes(x = playlist_genre, y = energy, fill = playlist_genre)) +
  geom_boxplot(color = "black") +
  labs(title = "Energy Distribution Across Playlist Genre", x = "Playlist Genre", y = "Energy") +
  scale_fill_manual(values = c("green", "green", "green", "green", "green", "green")) + 
  theme_minimal() +
  theme(legend.position = "none") 

ggsave("Genre-Energy.png", bg = "white")


```
**Naziv grafa:** Distribucija Energije prema Žanrovima Playlista

**Opis:**
Ovaj boxplot graf prikazuje distribuciju energije (y-osa) na temelju različitih žanrova playlista (x-osa). Svaki boxplot predstavlja jedan žanr, a njegova širina odražava raspon energije unutar tog žanra. Unutar svakog boxplota nalazi se pravokutnik koji predstavlja interkvartilni raspon, a linija unutar pravokutnika označava medijan energije.

Iako su boje živahne (zelena nijansa), važno je primijetiti da se energija ne raspoređuje jednolično među žanrovima. Odsutnost legende ukazuje na to da su boje žanrova ujednačene, ali različite nijanse mogu ukazivati na varijacije unutar samih žanrova.

Dodatno, postojanje "notcha" u sredini svakog boxplota pruža informaciju o razlikama u medijanima između žanrova. Ako se notchovi preklapaju, to može sugerirati da nema značajne razlike u mediani između određenih žanrova.

Ovaj vizualni prikaz pomaže razumjeti raspon energije unutar različitih žanrova playlista, dok notchi i boxplotovi omogućuju usporedbu centralnih mjera energije između tih žanrova.



```{r}
ggplot(df, aes(x = danceability, y = energy, color = track_popularity)) +
  geom_point(alpha = 0.9) +
  labs(title = "Danceability and Energy with Popularity Color", x = "Danceability", y = "Energy", color = "Popularity") +
  scale_color_continuous(name = "Popularity", low = "green", high = "red") +
  theme_minimal()

ggsave("Dance-Energy-popularity.png", bg = "white")



```
**Naziv grafa:** Plesnost naspram Energije s Bojom prema Popularnosti

**Opis:**
Ovaj šareni graf prikazuje odnos između plesnosti (x-osa) i energije (y-osa) za različite glazbene pjesme. Svaka točka na grafu predstavlja pojedinu pjesmu, a njezina boja označava razinu popularnosti. Tamnije crvene nijanse označavaju popularnije pjesme, dok svjetlije plave nijanse ukazuju na manju popularnost.

Unatoč šarenilu grafa, važno je primijetiti da plesnost i energija nisu usko povezane s popularnošću. To znači da ne postoji jasna korelacija između ovih glazbenih karakteristika i razine popularnosti pjesama. Točke se raspršuju po grafu, pokazujući raznolikost glazbenog ukusa i potvrđujući da ne postoji jednostavan obrazac koji bi povezao plesnost, energiju i popularnost.

Graf pruža uvid u raznolikost glazbenih preferencija te naglašava da glazbene osobitosti kao što su plesnost i energija nisu nužno ključni faktori koji određuju popularnost pjesama na temelju analize ovog skupa podataka.


```{r}
df_subgenres <- df %>% group_by(playlist_genre, playlist_subgenre) %>% summarise(count = n())
ggplot(df_subgenres, aes(x = playlist_genre, y = count, fill = playlist_subgenre)) +
  geom_bar(stat = "identity", position = "stack", width = 0.95, color = "white") +
  labs(title = "Distribution of Genres with Subgenres", x = "Genre", y = "Count") +
  theme(
    legend.position = "right",
    axis.text.x = element_text(angle = 60, hjust = 1)
  ) +
  guides(fill = guide_legend(title = "Subgenre")) 


ggsave("Genre-Subgenre.png", bg = "white")


```
**Naziv grafa:** Raspodjela Žanrova s Podžanrovima na Playlistama

**Opis:**
Ovaj graf prikazuje broj playlista unutar određenih glavnih žanrova, razdijeljenih prema podžanrovima. Na x-osi su navedeni glavni žanrovi playlista, dok y-osa pokazuje broj playlista. Svaki šareni segment na stupcu predstavlja određeni podžanr unutar glavnog žanra na playlisti.

Stupci su složeni jedan na drugi kako bi se vizualno prikazala distribucija podžanrova u okviru svakog glavnog žanra. Debljina svakog pojedinog stupca predstavlja ukupan broj playlista u određenom glavnom žanru.

Ovaj graf pruža pregled raznolikosti glazbenih playlista u skladu s glavnim žanrovima i dodatno razdvaja podžanrove, omogućavajući bolje razumijevanje kako su playliste distribuirane unutar različitih glazbenih kategorija. Legenda s desne strane prikazuje koje boje predstavljaju određene podžanrove na playlistama.


```{r}
top_artists <- df %>%
  group_by(track_artist) %>%
  summarise(avg_popularity = mean(track_popularity)) %>%
  top_n(10, avg_popularity)

ggplot(top_artists, aes(x = reorder(track_artist, -avg_popularity), y = avg_popularity, fill = track_artist)) +
  geom_bar(stat = "identity") +
  labs(title = "Top 10 Artists Based on Popularity", x = "Artist", y = "Average Popularity") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggsave("Top 10 populari.png", bg = "white")

```




